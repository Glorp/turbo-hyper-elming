<html>

<head>
  <title>Ting</title>
  <script src="resources/elm-runtime.js"></script>
  <script src="build/Graphecs.js"></script>
  <script src="build/Ting.js"></script>
</head>

<body/>

<script type="text/javascript">
  var ting = Elm.fullscreen(Elm.Ting, {inn: null});

    function thingety(req) {
        if (req) ting.ports.inn.send([req, null]);
        else {
            ting.ports.inn.send(null);
            if (!req) return;
        }

        var xhr = new XMLHttpRequest();
        xhr.open(req.verb, req.url, true);
        xhr.setRequestHeader("accept", "application/vnd.siren+json");
        xhr.onload = function(){
            ting.ports.inn.send([req,
                                 {body: xhr.responseText,
                                  status: xhr.status,
                                  statusText: xhr.statusText,
                                  headers : xhr.getAllResponseHeaders()}]);
        }
        xhr.send();
    }

    ting.ports.out.subscribe(thingety);
</script>
</html>
